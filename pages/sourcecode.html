<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <link href="../style.css" rel="stylesheet" type="text/css" />

        <link rel="icon" href="../assets/waterit_logo.png" type="image/png" />
        <title>Water It</title>
    </head>
    <body>
        <div class="header_container">
            <div class="header_left">
                <h1 class="header-logo">Water It</h1>
                <p class="header-slogan">Your plant. Water it.</p>
            </div>
            <div class="header_right">
                <ul class="header-links">
                    <li class="header-link">
                        <a href="../index.html">Product</a>
                    </li>
                    <li class="header-link active">
                        <a href="">Source Code</a>
                    </li>
                    <li class="header-link">
                        <a href="./build.html">Build</a>
                    </li>
                    <li class="header-link">
                        <a href="./report.html">Report</a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="body_container">
            <div class="navbar_container">
                <ul class="navbar-links">
                    <li class="navbar-link">
                        <div class="navbar-anchor_container">
                            <a class="navbar-anchor" href="#sec-intro"
                                >Introduction</a
                            >
                        </div>
                    </li>
                    <li class="navbar-link">
                        <div class="navbar-anchor_container">
                            <a class="navbar-anchor" href="#sec-onstart"
                                >On Start</a
                            >
                        </div>
                    </li>
                    <li class="navbar-link">
                        <div class="navbar-anchor_container">
                            <a class="navbar-anchor" href="#sec-onapressed"
                                >On A Pressed</a
                            >
                        </div>
                    </li>
                    <li class="navbar-link">
                        <div class="navbar-anchor_container">
                            <a class="navbar-anchor" href="#sec-onbpressed"
                                >On B Pressed</a
                            >
                        </div>
                    </li>
                    <li class="navbar-link">
                        <div class="navbar-anchor_container">
                            <a class="navbar-anchor" href="#sec-onabpressed"
                                >On A + B Pressed</a
                            >
                        </div>
                    </li>
                    <li class="navbar-link">
                        <div class="navbar-anchor_container">
                            <a class="navbar-anchor" href="#sec-onlogopressed"
                                >On Logo Pressed</a
                            >
                        </div>
                    </li>
                    <li class="navbar-link">
                        <div class="navbar-anchor_container">
                            <a class="navbar-anchor" href="#sec-forever"
                                >Forever</a
                            >
                        </div>
                    </li>
                    <li class="navbar-link">
                        <div class="navbar-anchor_container">
                            <a
                                class="navbar-anchor"
                                href="#sec-puttingitalltogether"
                                >Full Code</a
                            >
                        </div>
                    </li>
                </ul>
            </div>
            <div class="content_container">
                <div class="section_container" id="sec-intro">
                    <div class="box_container">
                        <div class="text_container">
                            <div class="typewriter">
                                <h2>Source Code Introduction</h2>
                            </div>
                            <p>
                                The code that operates our Smart Plant Managing
                                Device is divided into the parts as you see in
                                the navigation bar beside. This page will
                                explain all of the code that will be used to
                                control our product. For simplicity and to make
                                this explanation user-friendly, we've decided to
                                code the micro:bit entirely with MakeCode. By
                                doing this, we have full access to all of the
                                functions of the micro:bit, and there will be no
                                need to rummage through what each function does
                                or its parameters. To make everything more
                                interactive on this website, we have decided to
                                add embeds of the MakeCode and the micro:bit
                                simulator to provide more context and a visual
                                representation to understand what is happening
                                with the code. All of the details related to the
                                micro:bit can be accessed on the
                                <a
                                    class="text-link"
                                    href="https://microbit.org/"
                                    target="_blank"
                                    >official micro:bit website</a
                                >.
                            </p>
                        </div>
                        <img
                            src="https://img-prod-cms-rt-microsoft-com.akamaized.net/cms/api/am/imageFileData/RWPeCc?ver=54f5&q=90&m=6&h=405&w=720&b=%23FFFFFFFF&l=f&o=t"
                            alt=""
                            style="
                                width: 200px;
                                object-fit: contain;
                                margin-left: 20px;
                            "
                        />
                    </div>
                </div>
                <div class="section_container" id="sec-onstart">
                    <div class="box_container" style="min-width: 500px">
                        <div
                            class="text_conatiner"
                            style="margin-right: 20px; max-width: 55%"
                        >
                            <h2>On Start</h2>
                            <p>
                                On start, these variables will be cleared and
                                these default start values will be assign to
                                them. We are setting the
                                <code>brightness</code> of the LEDs on the
                                micro:bit to <code>64</code> in order to save
                                energy. The following will describe the use of
                                each of the variables and they default values on
                                start:
                            </p>
                            <br />
                            <p>
                                <code>let select = false</code>: This variable
                                stores a value either <code>false</code> or
                                <code>true</code> to indicate the state of
                                "Select Mode". When Select Mode is
                                <code>true</code> you can select the time
                                between each watering when in manual mode. To
                                turn on select mode press the logo and use
                                button "A" to decrease the time and button "B"
                                to increase time. When you have your preferred
                                time click button "A" and "B" together to turn
                                on and off manual mode.
                            </p>
                            <p>
                                <code>let manual = false</code>: This variable
                                defines the state of the mirco:bit will be
                                running and will be changing how the buttons A
                                and B will react when pressed. Manual mode will
                                allow the system to water your plant in a set
                                duration of time. On start, this will be set to
                                <code>false</code>.
                            </p>
                            <p>
                                <code>let auto = true</code>: This variable
                                defines the state of the mirco:bit will be
                                running and will be changing how the buttons A
                                and B will react when pressed. Automatic mode
                                will allow the system to water your plant when
                                it detects the soil moisture is low. On start,
                                this will be set to <code>true</code>.
                            </p>
                            <br />
                            <p>
                                <code>let reading = 0</code>: The
                                <code>reading</code> variable is used to store
                                the reading of the soil moisture by detecting
                                the resistence in soil. This variable will be
                                used later as for showing the moisture level as
                                well as used to water the plant automatically if
                                the moisture level is low. Set to
                                <code>0</code> by default as there is no
                                reading.
                            </p>
                            <p>
                                <code>let time = 1</code>: The
                                <code>time</code> variable is used to store the
                                time between each time the system will water the
                                plant. This will be set to 1 by default. The
                                time measurement of the intervals will be in 10
                                seconds (doesn't affect the time it takes to
                                water).
                            </p>
                            <p>
                                <code>let wateringTime = 1</code>: The
                                <code>wateringTime</code> variable is used to
                                store how much time it will stall and let the
                                water drop from the piping. This will be set to
                                5 by default. The time measurement of the
                                intervals will be in seconds.
                            </p>
                        </div>
                        <div
                            style="
                                position: relative;
                                height: calc(600px + 5em);
                                width: 100%;
                                overflow: hidden;
                            "
                        >
                            <iframe
                                style="
                                    position: absolute;
                                    top: 0;
                                    left: 0;
                                    width: 100%;
                                    height: 100%;
                                "
                                src="https://makecode.microbit.org/---codeembed#pub:_LdJL9zRzP0ix"
                                allowfullscreen="allowfullscreen"
                                frameborder="0"
                                sandbox="allow-scripts allow-same-origin"
                            ></iframe>
                        </div>
                    </div>
                </div>
                <div class="section_container" id="sec-onapressed">
                    <div class="box_container" style="min-width: 500px">
                        <div
                            class="text_conatiner"
                            style="margin-right: 20px; max-width: 55%"
                        >
                            <h2>On A Pressed</h2>
                            <p>
                                Like stated above, Button A has different
                                functions depending on if you are increasing the
                                number count on the time interval for if you set
                                the watering divice to select mode (watering at
                                a set interval -- moisture level doesn't
                                matter).
                            </p>
                            <br />
                            <p>
                                This is all controlled by the
                                <code>select</code> variable and an
                                <code>if</code> statement.
                            </p>
                            <br />
                            <p>
                                If the <code>select</code> variable is set to
                                true, that means Button A's function will be to
                                decrease time interval for manual mode.
                            </p>
                            <br />
                            <p>
                                Else, if the <code>select</code> variable is not
                                set to true, that means Button A's function will
                                be to display the moisture level reading.
                            </p>
                        </div>
                        <div
                            style="
                                position: relative;
                                height: calc(300px + 5em);
                                width: 100%;
                                overflow: hidden;
                            "
                        >
                            <iframe
                                style="
                                    position: absolute;
                                    top: 0;
                                    left: 0;
                                    width: 100%;
                                    height: 100%;
                                "
                                src="https://makecode.microbit.org/---codeembed#pub:_0uAWar81MaMy"
                                allowfullscreen="allowfullscreen"
                                frameborder="0"
                                sandbox="allow-scripts allow-same-origin"
                            ></iframe>
                        </div>
                    </div>
                </div>
                <div class="section_container" id="sec-onbpressed">
                    <div class="box_container" style="min-width: 500px">
                        <div
                            class="text_conatiner"
                            style="margin-right: 20px; max-width: 55%"
                        >
                            <h2>On B Pressed</h2>
                            <p>
                                Similar to the duo functions in Button A, Button
                                B's functions include changing the time interval
                                for select mode and displaying the room
                                temperature reading.
                            </p>
                            <br />
                            <p>
                                This is all controlled by the
                                <code>select</code> variable and an
                                <code>if</code> statement.
                            </p>
                            <br />
                            <p>
                                If the <code>select</code> variable is set to
                                true, that means Button B's function will be to
                                increase time interval for manual mode.
                            </p>
                            <br />
                            <p>
                                Else, if the <code>select</code> variable is not
                                set to true, that means Button B's function will
                                be to display the temperature reading in the
                                room.
                            </p>
                        </div>
                        <div
                            style="
                                position: relative;
                                height: calc(300px + 5em);
                                width: 100%;
                                overflow: hidden;
                            "
                        >
                            <iframe
                                style="
                                    position: absolute;
                                    top: 0;
                                    left: 0;
                                    width: 100%;
                                    height: 100%;
                                "
                                src="https://makecode.microbit.org/---codeembed#pub:_0FtJ438z1MfT"
                                allowfullscreen="allowfullscreen"
                                frameborder="0"
                                sandbox="allow-scripts allow-same-origin"
                            ></iframe>
                        </div>
                    </div>
                </div>
                <div class="section_container" id="sec-onabpressed">
                    <div class="box_container" style="min-width: 500px">
                        <div
                            class="text_conatiner"
                            style="margin-right: 20px; max-width: 55%"
                        >
                            <h2>On A + B Pressed</h2>
                            <p>
                                The main purpose for A + B to be pressed is to
                                switch between manual and automatic mode. This
                                action will act as a toggle between the two.
                            </p>
                            <br />
                            <p>
                                The first step to clear the screen of the
                                micro:bit to display the mode that it switched
                                to. Then we will be changing the
                                <code>select</code> variable to false (incase
                                selection is still active, we need to reset it).
                                An if statement will follow up to check if the
                                variable has been changed to false and then
                                continue to run the action.
                            </p>
                            <br />
                            <p>
                                Next we will be following up with a
                                <code>if</code> statement which will control the
                                toggle part of this action.
                            </p>
                            <br />
                            <p>
                                If the <code>auto</code> variable is set to
                                <code>true</code>, this means auto mode is
                                currently on, thus we must change it to false
                                and toggle to manual mode. So we set the
                                <code>manual</code> variable to
                                <code>true</code> and the
                                <code>auto</code> variable to
                                <code>false</code>. Then we will display that
                                the state has been set to manual mode. Clear
                                screen after.
                            </p>
                            <br />
                            <p>
                                Else if the <code>auto</code> variable is set to
                                <code>false</code>, this means auto mode is
                                currently off, thus we must change it to true
                                and toggle to auto mode. So we set the
                                <code>manual</code> variable to
                                <code>false</code> and the
                                <code>auto</code> variable to <code>true</code>.
                                Then we will display that the state has been set
                                to auto mode. Clear screen after.
                            </p>
                        </div>
                        <div
                            style="
                                position: relative;
                                height: calc(400px + 5em);
                                width: 100%;
                                overflow: hidden;
                            "
                        >
                            <iframe
                                style="
                                    position: absolute;
                                    top: 0;
                                    left: 0;
                                    width: 100%;
                                    height: 100%;
                                "
                                src="https://makecode.microbit.org/---codeembed#pub:_EXaW0dMewM9a"
                                allowfullscreen="allowfullscreen"
                                frameborder="0"
                                sandbox="allow-scripts allow-same-origin"
                            ></iframe>
                        </div>
                    </div>
                </div>
                <div class="section_container" id="sec-onlogopressed">
                    <div class="box_container" style="min-width: 500px">
                        <div
                            class="text_conatiner"
                            style="margin-right: 20px; max-width: 55%"
                        >
                            <h2>On Logo Pressed</h2>
                            <p>
                                Pressing the logo will open the interval time
                                selection menu for manual mode. The main purpose
                                is to take and store a number value for the
                                interval when manual mode is turned on to water
                                the plant at a set time interval regardless of
                                the soil moisture. While the user is selecting a
                                variable buttons A and B will have different
                                functions as it will now be used to change the
                                value of the time interval.
                            </p>
                            <br />
                            <p>
                                First, we will be setting the
                                <code>select</code> variable to
                                <code>true</code> as we are now in interval time
                                select mode. Next we will display "select time"
                                so the user knows they are selecting the time
                                interval.
                            </p>
                            <br />
                            <p>
                                The next will be handled by a while loop and
                                will used to display the selected time interval
                                as the user decreases or increases the value.
                                While the <code>select</code> variable is
                                <code>true</code> we will be display these
                                values.
                            </p>
                            <br />
                            <p>
                                Last part of this function is to handle not
                                letting the user select a negative value (no
                                negative time, time travel?) or 0. If the
                                <code>time</code> variable is smaller than
                                <code>1</code>, we will set the time back to
                                <code>1</code> -- this eliminates letting the
                                user selecting a value smaller than
                                <code>1</code>. Then show the value.
                            </p>
                            <br />
                            <p>
                                Else if the <code>time</code> variable isn't
                                less than <code>1</code>, we just need to show
                                the value.
                            </p>
                        </div>
                        <div
                            style="
                                position: relative;
                                height: calc(400px + 5em);
                                width: 100%;
                                overflow: hidden;
                            "
                        >
                            <iframe
                                style="
                                    position: absolute;
                                    top: 0;
                                    left: 0;
                                    width: 100%;
                                    height: 100%;
                                "
                                src="https://makecode.microbit.org/---codeembed#pub:_VwkY5LFh3aUb"
                                allowfullscreen="allowfullscreen"
                                frameborder="0"
                                sandbox="allow-scripts allow-same-origin"
                            ></iframe>
                        </div>
                    </div>
                </div>
                <div class="section_container" id="sec-forever">
                    <div class="box_container" style="min-width: 500px">
                        <div
                            class="text_conatiner"
                            style="margin-right: 20px; max-width: 55%"
                        >
                            <h2>Forever</h2>
                            <p>
                                The <code>forever</code> function of this
                                product is one of the most important parts as it
                                is what does all of the automation (either
                                manual or auto mode).
                            </p>
                            <br />
                            <p>
                                The first thing it will do is to check if the
                                user is in selection mode via the
                                <code>select</code> variable. If not, it will
                                then continue doing its forever tasks.
                            </p>
                            <br />
                            <p>
                                The second thing we will do as a cosmetic is to
                                plot graph the moisture level of the soil that
                                is being detected. The more leds plotted will
                                mean that the moisture level is higher. Note
                                this is a built-in fuction that does the led
                                plotting and ratio.
                            </p>
                            <br />
                            <p>
                                The first <code>if</code> statement handles the
                                funtioning if <code>auto</code> variable is
                                <code>true</code>, meaning that it is in auto
                                mode. We clear to screen to get ready for
                                putting a plot graph for a new reading for the
                                moisture level. Next we will be turning the pin
                                2 to high (1023) when reading the measurement as
                                stated in
                                <a
                                    class="text-link"
                                    href="https://makecode.microbit.org/projects/soil-moisture/code"
                                    target="_blank"
                                    >our reference</a
                                >, it saves electrictity and advoids corrosion
                                probes. Next, we will set the reading on pin 2
                                to the <code>reading</code> variable and then
                                set pin 2 back to low (0). Then with the plot
                                graph, we will display a ratio of the moisture
                                level of the soil. This next
                                <code>if</code> statement nested in the parent
                                <code>if</code> statement checks if the
                                <code>reading</code> variable is smaller than
                                750 which is considered dry soil. If
                                requirements are fulfilled, it will turn the
                                servos motor 130 degrees by writing to pin 16 to
                                135. This aims the pipe to the plant and allows
                                the water to flow through and drop into the
                                soil. After how many seconds (multiplied to
                                1,000,000 µs) set to the
                                <code>wateringTime</code> variable, enough water
                                should be watered and the pin 16 will be written
                                back to 0, thus turning the servos motor to its
                                original position not leting the water flow.
                            </p>
                            <br />
                            <p>
                                The second <code>if</code> statement handles the
                                funtioning if <code>manual</code> variable is
                                <code>true</code>, meaning that it is in manual
                                mode. First it will wait for the set time via
                                <code>time</code> variable multiplied by 10s
                                (10,000,000 µs). Next it will do the same thing
                                as in automode by writing 135 to pin 16 where
                                the servos motor is and will turn 130 degrees.
                                After 5s (5,000,000 µs), enough water should be
                                watered and the pin 16 will be written back to
                                0, thus turning the servos motor to its original
                                position not leting the water flow.
                            </p>
                        </div>
                        <div
                            style="
                                position: relative;
                                height: calc(550px + 5em);
                                width: 100%;
                                overflow: hidden;
                            "
                        >
                            <iframe
                                style="
                                    position: absolute;
                                    top: 0;
                                    left: 0;
                                    width: 100%;
                                    height: 100%;
                                "
                                src="https://makecode.microbit.org/---codeembed#pub:_6jPWXyTcw8oV"
                                allowfullscreen="allowfullscreen"
                                frameborder="0"
                                sandbox="allow-scripts allow-same-origin"
                            ></iframe>
                        </div>
                    </div>
                </div>
                <div class="section_container" id="sec-puttingitalltogether">
                    <div class="box_container" style="min-width: 500px">
                        <div class="text_conatiner">
                            <h2>Putting It All Together</h2>
                            <p>
                                <b>Make Code Link:</b>
                                <a
                                    href="https://makecode.microbit.org/_40kKiAemvWeH"
                                    class="text-link"
                                    >https://makecode.microbit.org/_40kKiAemvWeH</a
                                >
                            </p>
                            <p>
                                This is the code in Javascript, commented on
                                every line:
                            </p>
                            <br />
                            <pre
                                class="sourcecode_container"
                                id="sourcecode_container"
                            ></pre>
                        </div>
                    </div>
                </div>
                <div class="footer_container"></div>
            </div>
        </div>

        <script src="../script.js"></script>
    </body>
</html>
